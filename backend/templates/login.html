<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SELECTIQ Junior - Connexion</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" type="text/css" href="../static/css/login.css">
  
</head>
<body>
  <!-- Navigation -->
  <nav class="glass">
    <div class="brand">
      <i class="fas fa-briefcase"></i>
      <span>SELECTIQ Junior</span>
    </div>
  </nav>

  <!-- Floating Particles -->
  <div class="particles" id="particles"></div>

  <!-- Main Content -->
  <div class="login-container">
    <div class="login-card glass">
      <div class="login-header">
        <div class="login-logo">
          <i class="fas fa-user-lock"></i>
        </div>
        <h1 class="login-title">Connexion Sécurisée</h1>
        <p class="login-subtitle">Veuillez entrer vos identifiants pour accéder à votre espace personnel</p>
      </div>

      <!-- Success Message -->
      <div class="success-message" id="successMessage" style="display: none;">
        <i class="fas fa-check-circle"></i> Mot de passe réinitialisé avec succès !
      </div>

      <!-- Form Error Message -->
      <div class="form-error" id="formError">
        <i class="fas fa-exclamation-circle"></i> Email ou mot de passe incorrect
      </div>

      <form class="login-form" id="loginForm">
        <div class="form-group" id="emailGroup">
          <label for="email" class="form-label">Adresse Email</label>
          <div class="input-icon" id="emailIcon">
            <i class="fas fa-envelope"></i>
          </div>
          <input type="email" id="email" class="form-control" placeholder="email@exemple.com" required>
          
        </div>

        <div class="form-group" id="passwordGroup">
          <label for="password" class="form-label">Mot de Passe</label>
          <div class="input-icon" id="passwordIcon">
            <i class="fas fa-lock"></i>
          </div>
          <div class="password-container">
            <input type="password" id="password" class="form-control" placeholder="••••••••" required>
            <i class="fas fa-eye toggle-password" id="togglePassword"></i>
          </div>
          
        </div>

        <div class="form-options">
          <div class="checkbox-container">
            <input type="checkbox" id="remember">
            <label for="remember">Se souvenir de moi</label>
          </div>
          <a href="forgot-password.html" class="forgot-link">Mot de passe oublié ?</a>
        </div>

        <button type="submit" class="login-btn">
          <i class="fas fa-sign-in-alt" style="margin-right: 8px;"></i> Se connecter
        </button>
      </form>
    </div>
  </div>

  <!-- Footer -->
  <footer class="glass">
    <div class="footer-links">
      <a href="#" class="footer-link">Confidentialité</a>
      <a href="#" class="footer-link">Conditions</a>
      <a href="#" class="footer-link">Aide</a>
      <a href="#" class="footer-link">Contact</a>
    </div>
    <p class="copyright">© 2025 SELECTIQ Junior. Tous droits réservés.</p>
  </footer>
<script src="{{ url_for('static', filename='js/api.js') }}"></script>

  <script>
  // ===== Floating Particles Animation =====
  function createParticles() {
    const particlesContainer = document.getElementById('particles');
    const particleCount = 15;
    
    for (let i = 0; i < particleCount; i++) {
      const particle = document.createElement('div');
      particle.classList.add('particle');
      
      // Random size between 5px and 15px
      const size = Math.random() * 10 + 5;
      particle.style.width = `${size}px`;
      particle.style.height = `${size}px`;
      
      // Random position
      particle.style.left = `${Math.random() * 100}%`;
      particle.style.top = `${Math.random() * 100}%`;
      
      // Random animation duration and delay
      const duration = Math.random() * 20 + 10;
      const delay = Math.random() * 5;
      particle.style.animation = `float ${duration}s ${delay}s infinite linear`;
      
      particlesContainer.appendChild(particle);
    }
  }

  // ===== Password Visibility Toggle =====
  const togglePassword = document.getElementById('togglePassword');
  const password = document.getElementById('password');
  
  togglePassword.addEventListener('click', function() {
    const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
    password.setAttribute('type', type);
    this.classList.toggle('fa-eye');
    this.classList.toggle('fa-eye-slash');
  });

  // ===== Input Field Interactions =====
  const emailInput = document.getElementById('email');
  const passwordInput = document.getElementById('password');
  const emailIcon = document.getElementById('emailIcon');
  const passwordIcon = document.getElementById('passwordIcon');

  // Function to toggle icon visibility based on input
  function toggleIconVisibility(inputElement, iconElement) {
    if (inputElement.value.trim() !== '') {
      iconElement.classList.add('hidden');
    } else {
      iconElement.classList.remove('hidden');
    }
  }

  // Add event listeners for input fields
  emailInput.addEventListener('input', function() {
    toggleIconVisibility(emailInput, emailIcon);
    hideFormError();
  });

  passwordInput.addEventListener('input', function() {
    toggleIconVisibility(passwordInput, passwordIcon);
    hideFormError();
  });

  // Also check on focus and blur
  emailInput.addEventListener('focus', function() {
    toggleIconVisibility(emailInput, emailIcon);
  });

  emailInput.addEventListener('blur', function() {
    toggleIconVisibility(emailInput, emailIcon);
  });

  passwordInput.addEventListener('focus', function() {
    toggleIconVisibility(passwordInput, passwordIcon);
  });

  passwordInput.addEventListener('blur', function() {
    toggleIconVisibility(passwordInput, passwordIcon);
  });

  // Initialize particles when page loads
  window.addEventListener('load', createParticles);
  
  
 // Admin credentials system
// ===== BASE64 ENCODED CREDENTIALS =====

const ADMIN_EMAIL = atob("c2VsZWN0aXFhZEBnbWFpbC5jb20=");




function getAdminCredentials() {
    // Always use the database, don't rely on localStorage
    return {
        email: atob("c2VsZWN0aXFhZEBnbWFpbC5jb20="), // selectiqad@gmail.com
        password: "" // Empty to force database check
    };
}

  
  // Function to show form error
  function showFormError() {
    const formError = document.getElementById('formError');
    formError.style.display = 'block';
    
    // Add error classes to form groups
    document.getElementById('emailGroup').classList.add('has-error');
    document.getElementById('passwordGroup').classList.add('has-error');
    
    // Shake animation for error effect
    formError.style.animation = 'none';
    setTimeout(() => {
      formError.style.animation = 'shake 0.5s';
    }, 10);
  }
  
  // Function to hide form error
  function hideFormError() {
    const formError = document.getElementById('formError');
    formError.style.display = 'none';
    
    // Remove error classes from form groups
    document.getElementById('emailGroup').classList.remove('has-error');
    document.getElementById('passwordGroup').classList.remove('has-error');
  }
  
  // Function to show success message
  function showSuccessMessage() {
    const successMessage = document.getElementById('successMessage');
    successMessage.style.display = 'block';
    
    // Hide after 5 seconds
    setTimeout(() => {
      successMessage.style.display = 'none';
    }, 5000);
  }
  
  // Add shake animation to CSS
  const style = document.createElement('style');
  style.innerHTML = `
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
      20%, 40%, 60%, 80% { transform: translateX(5px); }
    }
  `;
  document.head.appendChild(style);
  
  // Check for password reset success
  document.addEventListener('DOMContentLoaded', function() {
    if (sessionStorage.getItem('passwordResetSuccess') === 'true') {
      showSuccessMessage();
      sessionStorage.removeItem('passwordResetSuccess');
    }
  });
 // Login form handler
// login.html - Update the login handler
document.getElementById('loginForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;

    try {
        const result = await ApiService.login(email, password);
        console.log('Login result:', result);
        
        if (result.success) {
            console.log('Login successful, redirecting to dashboard');
            window.location.href = '/dashboard';
        } else {
            showFormError();
        }
    } catch (error) {
        console.error('Login error:', error);
        showFormError();
    }
});

  // ===== Remember Me Functionality =====
  document.addEventListener('DOMContentLoaded', function() {
    // Check if there are saved credentials
    const rememberCheckbox = document.getElementById('remember');
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    
    // Load saved credentials if "Remember Me" was checked
    if (localStorage.getItem('rememberMe') === 'true') {
      rememberCheckbox.checked = true;
      emailInput.value = localStorage.getItem('savedEmail') || '';
      passwordInput.value = localStorage.getItem('savedPassword') || '';
    }
    
    // Update the Remember Me functionality when form is submitted
    document.getElementById('loginForm').addEventListener('submit', function(e) {
      if (rememberCheckbox.checked) {
        localStorage.setItem('rememberMe', 'true');
        localStorage.setItem('savedEmail', emailInput.value);
        localStorage.setItem('savedPassword', passwordInput.value);
      } else {
        localStorage.removeItem('rememberMe');
        localStorage.removeItem('savedEmail');
        localStorage.removeItem('savedPassword');
      }
    });
  });
</script>
<!-- Add this right before the closing </body> tag -->

</html>